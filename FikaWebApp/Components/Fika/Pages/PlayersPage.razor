@page "/Fika/Manage/Players"
@using FikaShared
@using FikaShared.Requests
@using FikaShared.Responses
@using FikaWebApp.Components.Fika.Dialogs
@using static FikaShared.Enums

@inject HttpClient HttpClient
@inject ISnackbar Snackbar
@inject IDialogService DialogService

<MudPaper Class="mud-width-full pa-2" MinHeight="100%" Style="position: relative;">
	<MudLoading Loading="_loading" Darken="true" Overlap="true" Text="Waiting for server...">
		<MudStack Row>
			<MudGrid>
				@foreach (var player in _players)
				{
					<MudItem xs="3">
						<MudCard Outlined="true">
							<MudCardMedia Image="@(player.Location.ToMapURL())" Height="200" Title="@player.Location.ToString()" />
							<MudCardHeader>
								<MudStack>
									<MudText Typo="Typo.h6">@player.Nickname</MudText>
								</MudStack>
							</MudCardHeader>
							<MudCardContent>
								<MudText>Level: @player.Level</MudText>
								<MudText>Location: @player.Location</MudText>
							</MudCardContent>
							<AuthorizeView Roles="Admin, Moderator">
								<MudCardActions>
									<MudButtonGroup Color="Color.Primary" Variant="Variant.Filled" FullWidth="true">
										<FikaPrimaryButton Text="Logout" StartIcon="@Icons.Material.Filled.Logout" OnClick="@(() => LogoutPlayer(player))" Disabled="@IsRestricted(player.Location)" />
										<FikaPrimaryButton Text="Send Message" StartIcon="@Icons.Material.Filled.Send" OnClick="@(() => SendMessage(player))" Disabled="@IsRestricted(player.Location)" />
									</MudButtonGroup>
								</MudCardActions>
							</AuthorizeView>
						</MudCard>
					</MudItem>
				}
			</MudGrid>
		</MudStack>
	</MudLoading>
</MudPaper>


